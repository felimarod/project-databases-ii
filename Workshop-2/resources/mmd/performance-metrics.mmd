%% Database Performance Metrics and Monitoring Dashboard
graph TB
    subgraph "PostgreSQL Performance Metrics"
        PG_METRICS["PostgreSQL Metrics<br/>----<br/>Query Latency P95: 45ms<br/>Transactions per second: 2,400<br/>Connection Efficiency: 95%<br/>Availability: 99.997%<br/>Storage Efficiency: 85%<br/>Cache Hit Ratio: 98.5%<br/>Replication Lag: <50ms<br/>WAL Generation: 2.1GB/hr<br/>Lock Waits: <1%<br/>Vacuum Efficiency: 94%"]
        
        PG_OPTIMIZATION["PostgreSQL Optimizations<br/>----<br/>shared_buffers: 8GB (25% RAM)<br/>work_mem: 256MB<br/>wal_buffers: 16MB<br/>checkpoint_segments: 64<br/>effective_cache_size: 24GB<br/>random_page_cost: 1.1<br/>default_statistics_target: 1000<br/>statement_timeout: 30s<br/>max_connections: 500<br/>connection_pooling: PgBouncer"]
    end

    subgraph "MongoDB Performance Metrics"
        MONGO_METRICS["MongoDB Metrics<br/>----<br/>Query Latency P95: 12ms<br/>Operations per second: 15,000<br/>Index Hit Ratio: 98.7%<br/>Replication Lag: <10ms<br/>Availability: 99.95%<br/>Storage Efficiency: 92%<br/>WiredTiger Cache: 16GB<br/>Sharding Efficiency: 96%<br/>Oplog Window: 48 hours<br/>Query Execution Time: 8ms avg"]
        
        MONGO_OPTIMIZATION["MongoDB Optimizations<br/>----<br/>Time-Series Collections: Enabled<br/>Compound Indexes: Optimized<br/>Sharding Strategy: Range-based<br/>Read Preference: secondaryPreferred<br/>WiredTiger Cache: 50% RAM<br/>Oplog Size: 10% disk space<br/>Collection Balancing: Enabled<br/>Aggregation Pipeline: Optimized<br/>Change Streams: Configured<br/>Compression: snappy"]
    end

    subgraph "Snowflake Performance Metrics"
        SNOWFLAKE_METRICS["Snowflake Metrics<br/>----<br/>Query Latency P95: 1.2s<br/>Queries per second: 45<br/>Cache Hit Rate: 87%<br/>Storage Efficiency: 97%<br/>Availability: 99.9%<br/>Credit Usage: 1,200/month<br/>Data Scanned: 2.1GB/hr<br/>Auto-scaling Events: 156/month<br/>Clustering Efficiency: 94%<br/>Time Travel Usage: 3 days avg"]
        
        SNOWFLAKE_OPTIMIZATION["Snowflake Optimizations<br/>----<br/>Warehouse Sizing: Auto-scale<br/>Auto-suspend: 1 minute<br/>Materialized Views: 12 active<br/>Clustering Keys: 8 tables<br/>Result Caching: 24 hours<br/>Query Optimization: Enabled<br/>Zero-copy Cloning: Active<br/>Data Sharing: Configured<br/>Micro-partitions: Optimized<br/>Compression Ratio: 6:1"]
    end

    subgraph "System-Wide Performance KPIs"
        API_METRICS["API Gateway Metrics<br/>----<br/>Requests per second: 5,000<br/>Latency P95: 120ms<br/>Availability: 99.99%<br/>Error Rate: 0.02%<br/>Rate Limit Hits: 0.1%<br/>Throughput: 45MB/s<br/>Circuit Breaker: 0 trips<br/>Cache Hit Rate: 85%"]
        
        BUSINESS_METRICS["Business Metrics<br/>----<br/>Daily Active Users: 15,000<br/>Daily Trade Volume: $2.5M<br/>Trade Execution: 50ms avg<br/>Alert Delivery: 200ms avg<br/>Market Data Lag: <5ms<br/>System Uptime: 99.997%<br/>Infrastructure Cost: -35%<br/>User Satisfaction: 94%<br/>Data Sync Lag: 38ms avg<br/>SLA Compliance: 99.8%"]
    end

    subgraph "Monitoring & Alerting Infrastructure"
        MONITORING_STACK["Monitoring Stack<br/>----<br/>Grafana Dashboards: 24<br/>Prometheus Metrics: 2,847<br/>ELK Log Processing: 1.2TB/day<br/>Alert Rules: 156 active<br/>PagerDuty Integration: Enabled<br/>Custom Metrics: 342<br/>Retention Policy: 90 days<br/>Health Checks: 45 endpoints<br/>SLI/SLO Tracking: Active<br/>Capacity Planning: Automated"]
        
        ALERT_THRESHOLDS["Alert Thresholds<br/>----<br/>PostgreSQL CPU: >80%<br/>MongoDB Memory: >85%<br/>Snowflake Credits: >1000/day<br/>API Latency: >500ms<br/>Disk Usage: >90%<br/>Connection Pool: >80%<br/>Replication Lag: >100ms<br/>Error Rate: >1%<br/>Downtime: >30s<br/>SLA Breach: <99.9%"]
    end

    subgraph "Performance Optimization Roadmap"
        CURRENT_STATE["Current State<br/>----<br/>37% latency reduction achieved<br/>98.7% data consistency<br/>42% cost optimization<br/>99.997% availability<br/>Real-time processing: <5ms<br/>Auto-scaling implemented<br/>Monitoring dashboard active<br/>Backup/DR procedures tested"]
        
        OPTIMIZATION_TARGETS["Optimization Targets<br/>----<br/>Target: 50% latency reduction<br/>Target: 99.9% data consistency<br/>Target: 60% cost optimization<br/>Target: 99.99% availability<br/>Target: Real-time <2ms<br/>Target: Zero-downtime deployments<br/>Target: Predictive scaling<br/>Target: Edge computing integration"]
    end

    %% Performance Flow Connections
    PG_METRICS -.->|Real-time monitoring| MONITORING_STACK
    MONGO_METRICS -.->|Performance tracking| MONITORING_STACK
    SNOWFLAKE_METRICS -.->|Analytics monitoring| MONITORING_STACK
    API_METRICS -.->|Gateway monitoring| MONITORING_STACK
    
    MONITORING_STACK -.->|Threshold monitoring| ALERT_THRESHOLDS
    ALERT_THRESHOLDS -.->|Performance feedback| PG_OPTIMIZATION
    ALERT_THRESHOLDS -.->|Optimization signals| MONGO_OPTIMIZATION
    ALERT_THRESHOLDS -.->|Resource optimization| SNOWFLAKE_OPTIMIZATION
    
    CURRENT_STATE -.->|Continuous improvement| OPTIMIZATION_TARGETS
    BUSINESS_METRICS -.->|KPI tracking| OPTIMIZATION_TARGETS
